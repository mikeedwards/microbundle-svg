{"version":3,"file":"cli.js","sources":["../src/lib/transform-fast-rest.js","../src/utils.js","../src/lib/babel-custom.js","../src/log-error.js","../src/lib/compressed-size.js","../src/lib/terser.js","../src/lib/option-normalization.js","../src/lib/package-info.js","../src/lib/css-modules.js","../src/index.js","../src/prog.js","../src/cli.js"],"sourcesContent":["/**\n * @type {import('@babel/core')}\n */\n\n/**\n * Transform ...rest parameters to [].slice.call(arguments,offset).\n * Demo: https://astexplorer.net/#/gist/70aaa0306db9a642171ef3e2f35df2e0/576c150f647e4936fa6960e0453a11cdc5d81f21\n * Benchmark: https://jsperf.com/rest-arguments-babel-pr-9152/4\n * @param {object} opts\n * @param {babel.template} opts.template\n * @param {babel.types} opts.types\n * @returns {babel.PluginObj}\n */\nexport default function fastRestTransform({ template, types: t }) {\n\tconst slice = template`var IDENT = Array.prototype.slice;`;\n\n\tconst VISITOR = {\n\t\tRestElement(path, state) {\n\t\t\tif (path.parentKey !== 'params') return;\n\n\t\t\t// Create a global _slice alias\n\t\t\tlet slice = state.get('slice');\n\t\t\tif (!slice) {\n\t\t\t\tslice = path.scope.generateUidIdentifier('slice');\n\t\t\t\tstate.set('slice', slice);\n\t\t\t}\n\n\t\t\t// _slice.call(arguments) or _slice.call(arguments, 1)\n\t\t\tconst args = [t.identifier('arguments')];\n\t\t\tif (path.key) args.push(t.numericLiteral(path.key));\n\t\t\tconst sliced = t.callExpression(\n\t\t\t\tt.memberExpression(t.clone(slice), t.identifier('call')),\n\t\t\t\targs,\n\t\t\t);\n\n\t\t\tconst ident = path.node.argument;\n\t\t\tconst binding = path.scope.getBinding(ident.name);\n\n\t\t\tif (binding.referencePaths.length !== 0) {\n\t\t\t\t// arguments access requires a non-Arrow function:\n\t\t\t\tconst func = path.parentPath;\n\t\t\t\tif (t.isArrowFunctionExpression(func)) {\n\t\t\t\t\tfunc.arrowFunctionToExpression();\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tbinding.constant &&\n\t\t\t\t\tbinding.referencePaths.length === 1 &&\n\t\t\t\t\tsameArgumentsObject(binding.referencePaths[0], func, t)\n\t\t\t\t) {\n\t\t\t\t\t// one usage, never assigned - replace usage inline\n\t\t\t\t\tbinding.referencePaths[0].replaceWith(sliced);\n\t\t\t\t} else {\n\t\t\t\t\t// unknown usage, create a binding\n\t\t\t\t\tconst decl = t.variableDeclaration('var', [\n\t\t\t\t\t\tt.variableDeclarator(t.clone(ident), sliced),\n\t\t\t\t\t]);\n\t\t\t\t\tfunc.get('body').unshiftContainer('body', decl);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpath.remove();\n\t\t},\n\t};\n\n\treturn {\n\t\tname: 'transform-fast-rest',\n\t\tvisitor: {\n\t\t\tProgram(path, state) {\n\t\t\t\tconst childState = new Map();\n\t\t\t\tconst useHelper = state.opts.helper === true; // defaults to false\n\n\t\t\t\tif (!useHelper) {\n\t\t\t\t\tlet inlineHelper;\n\t\t\t\t\tif (state.opts.literal === false) {\n\t\t\t\t\t\tinlineHelper = template.expression.ast`Array.prototype.slice`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinlineHelper = template.expression.ast`[].slice`;\n\t\t\t\t\t}\n\t\t\t\t\tchildState.set('slice', inlineHelper);\n\t\t\t\t}\n\n\t\t\t\tpath.traverse(VISITOR, childState);\n\n\t\t\t\tconst name = childState.get('slice');\n\t\t\t\tif (name && useHelper) {\n\t\t\t\t\tconst helper = slice({ IDENT: name });\n\t\t\t\t\tt.addComment(helper.declarations[0].init, 'leading', '#__PURE__');\n\t\t\t\t\tpath.unshiftContainer('body', helper);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t};\n}\n\nfunction sameArgumentsObject(node, func, t) {\n\twhile ((node = node.parentPath)) {\n\t\tif (node === func) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (t.isFunction(node) && !t.isArrowFunctionExpression(node)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn false;\n}\n","import { promises as fs } from 'fs';\nimport camelCase from 'camelcase';\n\nexport const readFile = fs.readFile;\n\nexport const stat = fs.stat;\n\nexport function isDir(name) {\n\treturn stat(name)\n\t\t.then(stats => stats.isDirectory())\n\t\t.catch(() => false);\n}\n\nexport function isFile(name) {\n\treturn stat(name)\n\t\t.then(stats => stats.isFile())\n\t\t.catch(() => false);\n}\n\n// eslint-disable-next-line no-console\nexport const stdout = console.log.bind(console);\nexport const stderr = console.error.bind(console);\n\nexport const isTruthy = obj => {\n\tif (!obj) {\n\t\treturn false;\n\t}\n\n\treturn obj.constructor !== Object || Object.keys(obj).length > 0;\n};\n\n/** Remove a @scope/ prefix from a package name string */\nexport const removeScope = name => name.replace(/^@.*\\//, '');\n\nconst INVALID_ES3_IDENT = /((^[^a-zA-Z]+)|[^\\w.-])|([^a-zA-Z0-9]+$)/g;\n\n/**\n * Turn a package name into a valid reasonably-unique variable name\n * @param {string} name\n */\nexport function safeVariableName(name) {\n\tconst normalized = removeScope(name).toLowerCase();\n\tconst identifier = normalized.replace(INVALID_ES3_IDENT, '');\n\treturn camelCase(identifier);\n}\n\nexport const EXTENSION = /(\\.(umd|cjs|es|m))?\\.([cm]?[tj]sx?)$/;\n","import { createBabelInputPluginFactory } from '@rollup/plugin-babel';\nimport merge from 'lodash.merge';\nimport transformFastRest from './transform-fast-rest';\nimport { isTruthy } from '../utils';\n\nconst ESMODULES_TARGET = {\n\tesmodules: true,\n};\n\nconst mergeConfigItems = (babel, type, ...configItemsToMerge) => {\n\tconst mergedItems = [];\n\n\tconfigItemsToMerge.forEach(configItemToMerge => {\n\t\tconfigItemToMerge.forEach(item => {\n\t\t\tconst itemToMergeWithIndex = mergedItems.findIndex(\n\t\t\t\tmergedItem =>\n\t\t\t\t\t(mergedItem.name || mergedItem.file.resolved) ===\n\t\t\t\t\t(item.name || item.file.resolved),\n\t\t\t);\n\n\t\t\tif (itemToMergeWithIndex === -1) {\n\t\t\t\tmergedItems.push(item);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmergedItems[itemToMergeWithIndex] = babel.createConfigItem(\n\t\t\t\t[\n\t\t\t\t\tmergedItems[itemToMergeWithIndex].file.resolved,\n\t\t\t\t\tmerge(mergedItems[itemToMergeWithIndex].options, item.options),\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\ttype,\n\t\t\t\t},\n\t\t\t);\n\t\t});\n\t});\n\n\treturn mergedItems;\n};\n\nconst createConfigItems = (babel, type, items) => {\n\treturn items.map(item => {\n\t\tlet { name, value, ...options } = item;\n\t\tvalue = value || [require.resolve(name), options];\n\t\treturn babel.createConfigItem(value, { type });\n\t});\n};\n\nconst environmentPreset = '@babel/preset-env';\n// capture both @babel/env & @babel/preset-env (https://babeljs.io/docs/en/presets#preset-shorthand)\nconst presetEnvRegex = new RegExp(/@babel\\/(preset-)?env/);\n\nexport default () => {\n\treturn createBabelInputPluginFactory(babelCore => {\n\t\treturn {\n\t\t\t// Passed the plugin options.\n\t\t\toptions({ custom: customOptions, ...pluginOptions }) {\n\t\t\t\treturn {\n\t\t\t\t\t// Pull out any custom options that the plugin might have.\n\t\t\t\t\tcustomOptions,\n\n\t\t\t\t\t// Pass the options back with the two custom options removed.\n\t\t\t\t\tpluginOptions,\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tconfig(config, { customOptions }) {\n\t\t\t\tconst targets = customOptions.targets;\n\t\t\t\tconst isNodeTarget = targets && targets.node != null;\n\n\t\t\t\tconst defaultPlugins = createConfigItems(\n\t\t\t\t\tbabelCore,\n\t\t\t\t\t'plugin',\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-syntax-import-meta',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.jsxImportSource && {\n\t\t\t\t\t\t\tname: '@babel/plugin-transform-react-jsx',\n\t\t\t\t\t\t\tpragma: customOptions.pragma || 'h',\n\t\t\t\t\t\t\tpragmaFrag: customOptions.pragmaFrag || 'Fragment',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.typescript && {\n\t\t\t\t\t\t\tname: '@babel/plugin-transform-flow-strip-types',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisTruthy(customOptions.defines) && {\n\t\t\t\t\t\t\tname: 'babel-plugin-transform-replace-expressions',\n\t\t\t\t\t\t\treplace: customOptions.defines,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.modern &&\n\t\t\t\t\t\t\t!isNodeTarget && {\n\t\t\t\t\t\t\t\tname: 'babel-plugin-transform-async-to-promises',\n\t\t\t\t\t\t\t\tinlineHelpers: true,\n\t\t\t\t\t\t\t\texternalHelpers: false,\n\t\t\t\t\t\t\t\tminify: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.modern &&\n\t\t\t\t\t\t\t!isNodeTarget && {\n\t\t\t\t\t\t\t\tvalue: [\n\t\t\t\t\t\t\t\t\ttransformFastRest,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t// Use inline [].slice.call(arguments)\n\t\t\t\t\t\t\t\t\t\thelper: false,\n\t\t\t\t\t\t\t\t\t\tliteral: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t'transform-fast-rest',\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-proposal-class-properties',\n\t\t\t\t\t\t\tloose: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.modern &&\n\t\t\t\t\t\t\t!isNodeTarget && {\n\t\t\t\t\t\t\t\tname: '@babel/plugin-transform-regenerator',\n\t\t\t\t\t\t\t\tasync: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'babel-plugin-macros',\n\t\t\t\t\t\t},\n\t\t\t\t\t].filter(Boolean),\n\t\t\t\t);\n\n\t\t\t\tconst babelOptions = config.options || {};\n\n\t\t\t\tconst envIdx = (babelOptions.presets || []).findIndex(preset =>\n\t\t\t\t\tpresetEnvRegex.test(preset.file.request),\n\t\t\t\t);\n\n\t\t\t\tif (envIdx !== -1) {\n\t\t\t\t\tconst preset = babelOptions.presets[envIdx];\n\t\t\t\t\tbabelOptions.presets[envIdx] = babelCore.createConfigItem(\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\trequire.resolve(environmentPreset),\n\t\t\t\t\t\t\tObject.assign(\n\t\t\t\t\t\t\t\tmerge(\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tloose: true,\n\t\t\t\t\t\t\t\t\t\tuseBuiltIns: false,\n\t\t\t\t\t\t\t\t\t\ttargets: customOptions.targets,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tpreset.options,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tbugfixes: customOptions.modern,\n\t\t\t\t\t\t\t\t\t\tmodules: false,\n\t\t\t\t\t\t\t\t\t\texclude: merge(\n\t\t\t\t\t\t\t\t\t\t\t['transform-async-to-generator', 'transform-regenerator'],\n\t\t\t\t\t\t\t\t\t\t\t(preset.options && preset.options.exclude) || [],\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tcustomOptions.modern ? { targets: ESMODULES_TARGET } : {},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: `preset`,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tbabelOptions.presets = createConfigItems(\n\t\t\t\t\t\tbabelCore,\n\t\t\t\t\t\t'preset',\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: environmentPreset,\n\t\t\t\t\t\t\t\ttargets: customOptions.modern\n\t\t\t\t\t\t\t\t\t? ESMODULES_TARGET\n\t\t\t\t\t\t\t\t\t: customOptions.targets,\n\t\t\t\t\t\t\t\tmodules: false,\n\t\t\t\t\t\t\t\tloose: true,\n\t\t\t\t\t\t\t\tuseBuiltIns: false,\n\t\t\t\t\t\t\t\tbugfixes: customOptions.modern,\n\t\t\t\t\t\t\t\texclude: [\n\t\t\t\t\t\t\t\t\t'transform-async-to-generator',\n\t\t\t\t\t\t\t\t\t'transform-regenerator',\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcustomOptions.jsxImportSource && {\n\t\t\t\t\t\t\t\tname: '@babel/preset-react',\n\t\t\t\t\t\t\t\truntime: 'automatic',\n\t\t\t\t\t\t\t\timportSource: customOptions.jsxImportSource,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t].filter(Boolean),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Merge babelrc & our plugins together\n\t\t\t\tbabelOptions.plugins = mergeConfigItems(\n\t\t\t\t\tbabelCore,\n\t\t\t\t\t'plugin',\n\t\t\t\t\tdefaultPlugins,\n\t\t\t\t\tbabelOptions.plugins || [],\n\t\t\t\t);\n\n\t\t\t\tif (customOptions.compress) {\n\t\t\t\t\tbabelOptions.generatorOpts = {\n\t\t\t\t\t\tminified: true,\n\t\t\t\t\t\tcompact: true,\n\t\t\t\t\t\tshouldPrintComment: comment => /[@#]__[A-Z]+__/.test(comment),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn babelOptions;\n\t\t\t},\n\t\t};\n\t});\n};\n","import { red, dim } from 'kleur';\nimport { stderr } from './utils';\n\nexport default function logError(err) {\n\tconst error = err.error || err;\n\tconst description = `${error.name ? error.name + ': ' : ''}${\n\t\terror.message || error\n\t}`;\n\tconst message = error.plugin\n\t\t? `(${error.plugin} plugin) ${description}`\n\t\t: description;\n\n\tstderr(red().bold(message));\n\n\tif (error.loc) {\n\t\tstderr();\n\t\tstderr(`at ${error.loc.file}:${error.loc.line}:${error.loc.column}`);\n\t}\n\n\tif (error.frame) {\n\t\tstderr();\n\t\tstderr(dim(error.frame));\n\t} else if (err.stack) {\n\t\tconst headlessStack = error.stack.replace(message, '');\n\t\tstderr(dim(headlessStack));\n\t}\n\n\tstderr();\n}\n","import { basename } from 'path';\nimport { green, red, yellow, white } from 'kleur';\nimport gzipSize from 'gzip-size';\nimport brotliSize from 'brotli-size';\nimport prettyBytes from 'pretty-bytes';\n\nfunction getPadLeft(str, width, char = ' ') {\n\treturn char.repeat(width - str.length);\n}\n\nfunction formatSize(size, filename, type, raw) {\n\tconst pretty = raw ? `${size} B` : prettyBytes(size);\n\tconst color = size < 5000 ? green : size > 40000 ? red : yellow;\n\tconst indent = getPadLeft(pretty, 13);\n\treturn `${indent}${color(pretty)}: ${white(basename(filename))}.${type}`;\n}\n\nexport async function getSizeInfo(code, filename, raw) {\n\traw = raw || code.length < 5000;\n\n\tconst [gzip, brotli] = await Promise.all([\n\t\tgzipSize(code).catch(() => null),\n\t\tbrotliSize(code).catch(() => null),\n\t]);\n\n\tlet out = formatSize(gzip, filename, 'gz', raw);\n\tif (brotli) {\n\t\tout += '\\n' + formatSize(brotli, filename, 'br', raw);\n\t}\n\n\treturn out;\n}\n","// Normalize Terser options from microbundle's relaxed JSON format (mutates argument in-place)\nexport function normalizeMinifyOptions(minifyOptions) {\n\t// ignore normalization if \"mangle\" is a boolean:\n\tif (typeof minifyOptions.mangle === 'boolean') return;\n\n\tconst mangle = minifyOptions.mangle || (minifyOptions.mangle = {});\n\tlet properties = mangle.properties;\n\n\t// allow top-level \"properties\" key to override mangle.properties (including {properties:false}):\n\tif (minifyOptions.properties != null) {\n\t\tproperties = mangle.properties =\n\t\t\tminifyOptions.properties &&\n\t\t\tObject.assign(properties, minifyOptions.properties);\n\t}\n\n\t// allow previous format ({ mangle:{regex:'^_',reserved:[]} }):\n\tif (minifyOptions.regex || minifyOptions.reserved) {\n\t\tif (!properties) properties = mangle.properties = {};\n\t\tproperties.regex = properties.regex || minifyOptions.regex;\n\t\tproperties.reserved = properties.reserved || minifyOptions.reserved;\n\t}\n\n\tif (properties) {\n\t\tif (properties.regex) properties.regex = new RegExp(properties.regex);\n\t\tproperties.reserved = [].concat(properties.reserved || []);\n\t}\n}\n","/**\n * Convert booleans and int define= values to literals.\n * This is more intuitive than `microbundle --define A=1` producing A=\"1\".\n */\nexport function toReplacementExpression(value, name) {\n\t// --define A=\"1\",B='true' produces string:\n\tconst matches = value.match(/^(['\"])(.+)\\1$/);\n\tif (matches) {\n\t\treturn [JSON.stringify(matches[2]), name];\n\t}\n\n\t// --define @assign=Object.assign replaces expressions with expressions:\n\tif (name[0] === '@') {\n\t\treturn [value, name.substring(1)];\n\t}\n\n\t// --define A=1,B=true produces int/boolean literal:\n\tif (/^(true|false|\\d+)$/i.test(value)) {\n\t\treturn [value, name];\n\t}\n\n\t// default: string literal\n\treturn [JSON.stringify(value), name];\n}\n\n/**\n * Parses values of the form \"$=jQuery,React=react\" into key-value object pairs.\n */\nexport function parseMappingArgument(globalStrings, processValue) {\n\tconst globals = {};\n\tglobalStrings.split(',').forEach(globalString => {\n\t\tlet [key, value] = globalString.split('=');\n\t\tif (processValue) {\n\t\t\tconst r = processValue(value, key);\n\t\t\tif (r !== undefined) {\n\t\t\t\tif (Array.isArray(r)) {\n\t\t\t\t\t[value, key] = r;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tglobals[key] = value;\n\t});\n\treturn globals;\n}\n\n/**\n * Parses values of the form \"$=jQuery,React=react\" into key-value object pairs.\n */\nexport function parseAliasArgument(aliasStrings) {\n\treturn aliasStrings.split(',').map(str => {\n\t\tlet [key, value] = str.split('=');\n\t\treturn { find: key, replacement: value };\n\t});\n}\n","import { resolve, basename } from 'path';\nimport { red, yellow } from 'kleur';\nimport { readFile, stderr, safeVariableName } from '../utils';\n\n/** */\nexport async function getConfigFromPkgJson(cwd) {\n\tlet hasPackageJson = false;\n\tlet pkg;\n\ttry {\n\t\tconst packageJson = await readFile(resolve(cwd, 'package.json'), 'utf8');\n\t\tpkg = JSON.parse(packageJson);\n\t\thasPackageJson = true;\n\t} catch (err) {\n\t\tconst pkgName = basename(cwd);\n\n\t\tstderr(\n\t\t\tyellow().inverse('WARN'),\n\t\t\tyellow(` no package.json, assuming package name is \"${pkgName}\".`),\n\t\t);\n\n\t\tlet msg = String(err.message || err);\n\t\tif (!msg.match(/ENOENT/)) stderr(`  ${red().dim(msg)}`);\n\n\t\tpkg = { name: pkgName };\n\t}\n\n\treturn { hasPackageJson, pkg };\n}\nexport function getName({ name, pkgName, amdName, cwd, hasPackageJson }) {\n\tif (!pkgName) {\n\t\tpkgName = basename(cwd);\n\t\tif (hasPackageJson) {\n\t\t\tstderr(\n\t\t\t\tyellow().inverse('WARN'),\n\t\t\t\tyellow(` missing package.json \"name\" field. Assuming \"${pkgName}\".`),\n\t\t\t);\n\t\t}\n\t}\n\n\tconst finalName = name || amdName || safeVariableName(pkgName);\n\n\treturn { finalName, pkgName };\n}\n","export function shouldCssModules(options) {\n\tconst passedInOption = processCssmodulesArgument(options);\n\n\t// We should module when my-file.module.css or my-file.css\n\tconst moduleAllCss = passedInOption === true;\n\n\t// We should module when my-file.module.css\n\tconst allowOnlySuffixModule = passedInOption === null;\n\n\treturn moduleAllCss || allowOnlySuffixModule;\n}\n\nexport function cssModulesConfig(options) {\n\tconst passedInOption = processCssmodulesArgument(options);\n\tconst isWatchMode = options.watch;\n\tconst hasPassedInScopeName = !(\n\t\ttypeof passedInOption === 'boolean' || passedInOption === null\n\t);\n\n\tif (shouldCssModules(options) || hasPassedInScopeName) {\n\t\tlet generateScopedName = isWatchMode\n\t\t\t? '_[name]__[local]__[hash:base64:5]'\n\t\t\t: '_[hash:base64:5]';\n\n\t\tif (hasPassedInScopeName) {\n\t\t\tgenerateScopedName = passedInOption; // would be the string from --css-modules \"_[hash]\".\n\t\t}\n\n\t\treturn { generateScopedName };\n\t}\n\n\treturn false;\n}\n\n/**\n * This is done because if you use the cli default property, you get a primiatve \"null\" or \"false\",\n * but when using the cli arguments, you always get back strings. This method aims at correcting those\n * for both realms. So that both realms _convert_ into primatives.\n */\nfunction processCssmodulesArgument(options) {\n\tif (options['css-modules'] === 'true' || options['css-modules'] === true)\n\t\treturn true;\n\tif (options['css-modules'] === 'false' || options['css-modules'] === false)\n\t\treturn false;\n\tif (options['css-modules'] === 'null' || options['css-modules'] === null)\n\t\treturn null;\n\n\treturn options['css-modules'];\n}\n","import fs from 'fs';\nimport { basename, dirname, extname, relative, resolve } from 'path';\nimport camelCase from 'camelcase';\nimport escapeStringRegexp from 'escape-string-regexp';\nimport { blue, red, yellow } from 'kleur';\nimport { map, series } from 'asyncro';\nimport glob from 'tiny-glob/sync';\nimport autoprefixer from 'autoprefixer';\nimport { rollup, watch } from 'rollup';\nimport builtinModules from 'builtin-modules';\nimport resolveFrom from 'resolve-from';\nimport commonjs from '@rollup/plugin-commonjs';\nimport babel from '@rollup/plugin-babel';\nimport customBabel from './lib/babel-custom';\nimport nodeResolve from '@rollup/plugin-node-resolve';\nimport { terser } from 'rollup-plugin-terser';\nimport { visualizer } from 'rollup-plugin-visualizer';\nimport alias from '@rollup/plugin-alias';\nimport postcss from 'rollup-plugin-postcss';\nimport typescript from 'rollup-plugin-typescript2';\nimport json from '@rollup/plugin-json';\nimport svgr from '@svgr/rollup';\nimport url from '@rollup/plugin-url';\nimport OMT from '@surma/rollup-plugin-off-main-thread';\nimport logError from './log-error';\nimport {\n\tEXTENSION,\n\tisDir,\n\tisFile,\n\tisTruthy,\n\tremoveScope,\n\tstdout,\n} from './utils';\nimport { getSizeInfo } from './lib/compressed-size';\nimport { normalizeMinifyOptions } from './lib/terser';\nimport {\n\tparseAliasArgument,\n\tparseMappingArgument,\n\ttoReplacementExpression,\n} from './lib/option-normalization';\nimport { getConfigFromPkgJson, getName } from './lib/package-info';\nimport { cssModulesConfig, shouldCssModules } from './lib/css-modules';\nimport { EOL } from 'os';\n\n// Extensions to use when resolving modules\nconst EXTENSIONS = ['.ts', '.tsx', '.js', '.jsx', '.es6', '.es', '.mjs'];\n\nconst WATCH_OPTS = {\n\texclude: 'node_modules/**',\n};\n\nexport default async function microbundle(inputOptions) {\n\tlet options = { ...inputOptions };\n\n\toptions.cwd = resolve(process.cwd(), inputOptions.cwd);\n\tconst cwd = options.cwd;\n\n\tconst { hasPackageJson, pkg } = await getConfigFromPkgJson(cwd);\n\toptions.pkg = {\n\t\t...pkg,\n\t\t...pkg.publishConfig,\n\t};\n\n\tconst { finalName, pkgName } = getName({\n\t\tname: options.name,\n\t\tpkgName: options.pkg.name,\n\t\tamdName: options.pkg.amdName,\n\t\thasPackageJson,\n\t\tcwd,\n\t});\n\n\toptions.name = finalName;\n\toptions.pkg.name = pkgName;\n\n\tif (options.sourcemap === 'inline') {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.log(\n\t\t\t'Warning: inline sourcemaps should only be used for debugging purposes.',\n\t\t);\n\t} else if (options.sourcemap === 'false') {\n\t\toptions.sourcemap = false;\n\t} else if (options.sourcemap !== false) {\n\t\toptions.sourcemap = true;\n\t}\n\n\toptions.input = await getInput({\n\t\tentries: options.entries,\n\t\tcwd,\n\t\tsource: options.pkg.source,\n\t\tmodule: options.pkg.module,\n\t});\n\n\toptions.output = await getOutput({\n\t\tcwd,\n\t\toutput: options.output,\n\t\tpkgMain: options.pkg.main,\n\t\tpkgName: options.pkg.name,\n\t});\n\n\toptions.entries = await getEntries({\n\t\tcwd,\n\t\tinput: options.input,\n\t});\n\n\toptions.multipleEntries = options.entries.length > 1;\n\n\tlet formats = (options.format || options.formats).split(',');\n\t// de-dupe formats and convert \"esm\" to \"es\":\n\tformats = Array.from(new Set(formats.map(f => (f === 'esm' ? 'es' : f))));\n\t// always compile cjs first if it's there:\n\tformats.sort((a, b) => (a === 'cjs' ? -1 : a > b ? 1 : 0));\n\n\tlet steps = [];\n\tfor (let i = 0; i < options.entries.length; i++) {\n\t\tfor (let j = 0; j < formats.length; j++) {\n\t\t\tsteps.push(\n\t\t\t\tcreateConfig(\n\t\t\t\t\toptions,\n\t\t\t\t\toptions.entries[i],\n\t\t\t\t\tformats[j],\n\t\t\t\t\ti === 0 && j === 0,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tif (options.watch) {\n\t\treturn doWatch(options, cwd, steps);\n\t}\n\n\tlet cache;\n\tlet out = await series(\n\t\tsteps.map(config => async () => {\n\t\t\tconst { inputOptions, outputOptions } = config;\n\t\t\tif (inputOptions.cache !== false) {\n\t\t\t\tinputOptions.cache = cache;\n\t\t\t}\n\t\t\tlet bundle = await rollup(inputOptions);\n\t\t\tcache = bundle;\n\t\t\tawait bundle.write(outputOptions);\n\t\t\treturn await config._sizeInfo;\n\t\t}),\n\t);\n\n\tconst targetDir = relative(cwd, dirname(options.output)) || '.';\n\tconst sourceExist = options.input.length > 0;\n\tconst banner = sourceExist\n\t\t? blue(`Build \"${options.pkg.name}\" to ${targetDir}:`)\n\t\t: red(`Error: No entry module found for \"${options.pkg.name}\"`);\n\treturn {\n\t\toutput: `${banner}\\n${out.join('\\n')}`,\n\t};\n}\n\nfunction doWatch(options, cwd, steps) {\n\tconst { onStart, onBuild, onError } = options;\n\n\treturn new Promise(resolve => {\n\t\tconst targetDir = relative(cwd, dirname(options.output));\n\t\tstdout(blue(`Watching source, compiling to ${targetDir}:`));\n\n\t\tconst watchers = steps.reduce((acc, options) => {\n\t\t\tacc[options.inputOptions.input] = watch(\n\t\t\t\tObject.assign(\n\t\t\t\t\t{\n\t\t\t\t\t\toutput: options.outputOptions,\n\t\t\t\t\t\twatch: WATCH_OPTS,\n\t\t\t\t\t},\n\t\t\t\t\toptions.inputOptions,\n\t\t\t\t),\n\t\t\t).on('event', e => {\n\t\t\t\tif (e.code === 'START') {\n\t\t\t\t\tif (typeof onStart === 'function') {\n\t\t\t\t\t\tonStart(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e.code === 'ERROR') {\n\t\t\t\t\tlogError(e.error);\n\t\t\t\t\tif (typeof onError === 'function') {\n\t\t\t\t\t\tonError(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e.code === 'END') {\n\t\t\t\t\tif (options._sizeInfo) {\n\t\t\t\t\t\toptions._sizeInfo.then(text => {\n\t\t\t\t\t\t\tstdout(`Wrote ${text.trim()}`);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof onBuild === 'function') {\n\t\t\t\t\t\tonBuild(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn acc;\n\t\t}, {});\n\n\t\tresolve({ watchers });\n\t});\n}\n\nasync function jsOrTs(cwd, filename) {\n\tconst extension = (await isFile(resolve(cwd, filename + '.ts')))\n\t\t? '.ts'\n\t\t: (await isFile(resolve(cwd, filename + '.tsx')))\n\t\t? '.tsx'\n\t\t: '.js';\n\n\treturn resolve(cwd, `${filename}${extension}`);\n}\n\nasync function getInput({ entries, cwd, source, module }) {\n\tconst input = [];\n\n\t[]\n\t\t.concat(\n\t\t\tentries && entries.length\n\t\t\t\t? entries\n\t\t\t\t: (source &&\n\t\t\t\t\t\t(Array.isArray(source) ? source : [source]).map(file =>\n\t\t\t\t\t\t\tresolve(cwd, file),\n\t\t\t\t\t\t)) ||\n\t\t\t\t\t\t((await isDir(resolve(cwd, 'src'))) &&\n\t\t\t\t\t\t\t(await jsOrTs(cwd, 'src/index'))) ||\n\t\t\t\t\t\t(await jsOrTs(cwd, 'index')) ||\n\t\t\t\t\t\tmodule,\n\t\t)\n\t\t.map(file => glob(file))\n\t\t.forEach(file => input.push(...file));\n\n\treturn input;\n}\n\nasync function getOutput({ cwd, output, pkgMain, pkgName }) {\n\tlet main = resolve(cwd, output || pkgMain || 'dist');\n\tif (!main.match(/\\.[a-z]+$/) || (await isDir(main))) {\n\t\tmain = resolve(main, `${removeScope(pkgName)}.js`);\n\t}\n\treturn main;\n}\n\nfunction getDeclarationDir({ options, pkg }) {\n\tconst { cwd, output } = options;\n\n\tlet result = output;\n\n\tif (pkg.types || pkg.typings) {\n\t\tresult = pkg.types || pkg.typings;\n\t\tresult = resolve(cwd, result);\n\t}\n\n\tresult = dirname(result);\n\n\treturn result;\n}\n\nasync function getEntries({ input, cwd }) {\n\treturn (\n\t\tawait map([].concat(input), async file => {\n\t\t\tfile = resolve(cwd, file);\n\t\t\tif (await isDir(file)) {\n\t\t\t\tfile = resolve(file, 'index.js');\n\t\t\t}\n\t\t\treturn file;\n\t\t})\n\t).filter((item, i, arr) => arr.indexOf(item) === i);\n}\n\nfunction replaceName(filename, name) {\n\treturn resolve(\n\t\tdirname(filename),\n\t\tname + basename(filename).replace(/^[^.]+/, ''),\n\t);\n}\n\nfunction walk(exports, includeDefault) {\n\tif (!exports) return null;\n\tif (typeof exports === 'string') return exports;\n\tlet p = exports['.'] || exports.import || exports.module;\n\tif (!p && includeDefault) p = exports.default;\n\treturn walk(p, includeDefault);\n}\n\nfunction getMain({ options, entry, format }) {\n\tconst { pkg } = options;\n\tconst pkgMain = options['pkg-main'];\n\tconst pkgTypeModule = pkg.type === 'module';\n\n\tif (!pkgMain) {\n\t\treturn options.output;\n\t}\n\n\tlet mainNoExtension = options.output;\n\tif (options.multipleEntries) {\n\t\tlet name = entry.match(new RegExp(/([\\\\/])index/.source + EXTENSION.source))\n\t\t\t? mainNoExtension\n\t\t\t: entry;\n\t\tmainNoExtension = resolve(dirname(mainNoExtension), basename(name));\n\t}\n\tmainNoExtension = mainNoExtension.replace(EXTENSION, '');\n\n\tconst mainsByFormat = {};\n\n\tmainsByFormat.es = replaceName(\n\t\tpkg.module && !pkg.module.match(/src\\//)\n\t\t\t? pkg.module\n\t\t\t: pkg['jsnext:main'] || pkgTypeModule\n\t\t\t? 'x.esm.js'\n\t\t\t: 'x.esm.mjs',\n\t\tmainNoExtension,\n\t);\n\n\tmainsByFormat.modern = replaceName(\n\t\t(pkg.exports && walk(pkg.exports, pkgTypeModule)) ||\n\t\t\t(pkg.syntax && pkg.syntax.esmodules) ||\n\t\t\tpkg.esmodule ||\n\t\t\tpkgTypeModule\n\t\t\t? 'x.modern.js'\n\t\t\t: 'x.modern.mjs',\n\t\tmainNoExtension,\n\t);\n\tmainsByFormat.cjs = replaceName(\n\t\tpkg['cjs:main'] || (pkgTypeModule ? 'x.cjs' : 'x.js'),\n\t\tmainNoExtension,\n\t);\n\tmainsByFormat.umd = replaceName(\n\t\tpkg['umd:main'] || pkg.unpkg || 'x.umd.js',\n\t\tmainNoExtension,\n\t);\n\n\treturn mainsByFormat[format] || mainsByFormat.cjs;\n}\n\n// shebang cache map because the transform only gets run once\nconst shebang = {};\n\nfunction createConfig(options, entry, format, writeMeta) {\n\tlet { pkg } = options;\n\n\t/** @type {(string|RegExp)[]} */\n\tlet external = ['dns', 'fs', 'path', 'url'];\n\n\t/** @type {Record<string, string>} */\n\tlet outputAliases = {};\n\n\tconst moduleAliases = options.alias ? parseAliasArgument(options.alias) : [];\n\tconst aliasIds = moduleAliases.map(alias => alias.find);\n\n\t// We want to silence rollup warnings for node builtins as we rollup-node-resolve threats them as externals anyway\n\t// @see https://github.com/rollup/plugins/tree/master/packages/node-resolve/#resolving-built-ins-like-fs\n\tif (options.target === 'node') {\n\t\texternal = [/node:.*/].concat(builtinModules);\n\t}\n\n\tconst peerDeps = Object.keys(pkg.peerDependencies || {});\n\tif (options.external === 'none') {\n\t\t// bundle everything (external=[])\n\t} else if (options.external) {\n\t\texternal = external.concat(peerDeps).concat(\n\t\t\t// CLI --external supports regular expressions:\n\t\t\toptions.external.split(',').map(str => new RegExp(str)),\n\t\t);\n\t} else {\n\t\texternal = external\n\t\t\t.concat(peerDeps)\n\t\t\t.concat(Object.keys(pkg.dependencies || {}));\n\t}\n\n\tlet globals = external.reduce((globals, name) => {\n\t\t// Use raw value for CLI-provided RegExp externals:\n\t\tif (name instanceof RegExp) name = name.source;\n\n\t\t// valid JS identifiers are usually library globals:\n\t\tif (name.match(/^[a-z_$][a-z0-9_\\-$]*$/)) {\n\t\t\tglobals[name] = camelCase(name);\n\t\t}\n\t\treturn globals;\n\t}, {});\n\tif (options.globals && options.globals !== 'none') {\n\t\tglobals = Object.assign(globals, parseMappingArgument(options.globals));\n\t}\n\n\tlet defines = {};\n\tif (options.define) {\n\t\tdefines = Object.assign(\n\t\t\tdefines,\n\t\t\tparseMappingArgument(options.define, toReplacementExpression),\n\t\t);\n\t}\n\n\tconst modern = format === 'modern';\n\n\t// let rollupName = safeVariableName(basename(entry).replace(/\\.js$/, ''));\n\n\tlet nameCache = {};\n\tconst bareNameCache = nameCache;\n\t// Support \"minify\" field and legacy \"mangle\" field via package.json:\n\tconst rawMinifyValue = options.pkg.minify || options.pkg.mangle || {};\n\tlet minifyOptions = typeof rawMinifyValue === 'string' ? {} : rawMinifyValue;\n\tconst getNameCachePath =\n\t\ttypeof rawMinifyValue === 'string'\n\t\t\t? () => resolve(options.cwd, rawMinifyValue)\n\t\t\t: () => resolve(options.cwd, 'mangle.json');\n\n\tconst useTypescript = extname(entry) === '.ts' || extname(entry) === '.tsx';\n\tconst emitDeclaration =\n\t\toptions.generateTypes == null\n\t\t\t? !!(pkg.types || pkg.typings)\n\t\t\t: options.generateTypes;\n\tconst useWorkerLoader = options.workers !== false;\n\n\tconst escapeStringExternals = ext =>\n\t\text instanceof RegExp ? ext.source : escapeStringRegexp(ext);\n\tconst externalPredicate = new RegExp(\n\t\t`^(${external.map(escapeStringExternals).join('|')})($|/)`,\n\t);\n\tconst externalTest =\n\t\texternal.length === 0 ? () => false : id => externalPredicate.test(id);\n\n\tlet endsWithNewLine = false;\n\n\tfunction loadNameCache() {\n\t\ttry {\n\t\t\tconst data = fs.readFileSync(getNameCachePath(), 'utf8');\n\t\t\tendsWithNewLine = data.endsWith(EOL);\n\t\t\tnameCache = JSON.parse(data);\n\t\t\t// mangle.json can contain a \"minify\" field, same format as the pkg.mangle:\n\t\t\tif (nameCache.minify) {\n\t\t\t\tminifyOptions = Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tminifyOptions || {},\n\t\t\t\t\tnameCache.minify,\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (e) {}\n\t}\n\tloadNameCache();\n\n\tnormalizeMinifyOptions(minifyOptions);\n\n\tif (nameCache === bareNameCache) nameCache = null;\n\n\t/** @type {false | import('rollup').RollupCache} */\n\tlet cache;\n\tif (modern) cache = false;\n\n\tconst absMain = resolve(options.cwd, getMain({ options, entry, format }));\n\tconst outputDir = dirname(absMain);\n\tconst outputEntryFileName = basename(absMain);\n\n\t// Warn about the (somewhat) breaking change in #950\n\tif (format === 'es' && !pkg.module && outputEntryFileName.endsWith('.mjs')) {\n\t\tstdout(\n\t\t\tyellow(\n\t\t\t\t'Warning: your package.json does not specify {\"type\":\"module\"}. Microbundle assumes this is a CommonJS package and is generating ES Modules with the \".mjs\" file extension.',\n\t\t\t),\n\t\t);\n\t}\n\n\tlet config = {\n\t\t/** @type {import('rollup').InputOptions} */\n\t\tinputOptions: {\n\t\t\t// disable Rollup's cache for modern builds to prevent re-use of legacy transpiled modules:\n\t\t\tcache,\n\t\t\tinput: entry,\n\t\t\texternal: id => {\n\t\t\t\tif (id === 'babel-plugin-transform-async-to-promises/helpers') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (aliasIds.indexOf(id) >= 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn externalTest(id);\n\t\t\t},\n\n\t\t\tonwarn(warning, warn) {\n\t\t\t\t// https://github.com/rollup/rollup/blob/0fa9758cb7b1976537ae0875d085669e3a21e918/src/utils/error.ts#L324\n\t\t\t\tif (warning.code === 'UNRESOLVED_IMPORT') {\n\t\t\t\t\tstdout(\n\t\t\t\t\t\t`Failed to resolve the module ${warning.source} imported by ${warning.importer}` +\n\t\t\t\t\t\t\t`\\nIs the module installed? Note:` +\n\t\t\t\t\t\t\t`\\n ↳ to inline a module into your bundle, install it to \"devDependencies\".` +\n\t\t\t\t\t\t\t`\\n ↳ to depend on a module via import/require, install it to \"dependencies\".`,\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\twarn(warning);\n\t\t\t},\n\n\t\t\ttreeshake: {\n\t\t\t\tpropertyReadSideEffects: false,\n\t\t\t},\n\n\t\t\tplugins: []\n\t\t\t\t.concat(\n\t\t\t\t\tpostcss({\n\t\t\t\t\t\tplugins: [autoprefixer()],\n\t\t\t\t\t\tautoModules: shouldCssModules(options),\n\t\t\t\t\t\tmodules: cssModulesConfig(options),\n\t\t\t\t\t\t// only write out CSS for the first bundle (avoids pointless extra files):\n\t\t\t\t\t\tinject: false,\n\t\t\t\t\t\textract:\n\t\t\t\t\t\t\t!!writeMeta &&\n\t\t\t\t\t\t\toptions.css !== 'inline' &&\n\t\t\t\t\t\t\toptions.output.replace(EXTENSION, '.css'),\n\t\t\t\t\t\tminimize: options.compress,\n\t\t\t\t\t\tsourceMap: options.sourcemap && options.css !== 'inline',\n\t\t\t\t\t}),\n\t\t\t\t\tmoduleAliases.length > 0 &&\n\t\t\t\t\t\talias({\n\t\t\t\t\t\t\t// @TODO: this is no longer supported, but didn't appear to be required?\n\t\t\t\t\t\t\t// resolve: EXTENSIONS,\n\t\t\t\t\t\t\tentries: moduleAliases,\n\t\t\t\t\t\t}),\n\t\t\t\t\tnodeResolve({\n\t\t\t\t\t\tmainFields: ['module', 'jsnext', 'main'],\n\t\t\t\t\t\tbrowser: options.target !== 'node',\n\t\t\t\t\t\texportConditions: [options.target === 'node' ? 'node' : 'browser'],\n\t\t\t\t\t\t// defaults + .jsx\n\t\t\t\t\t\textensions: ['.mjs', '.js', '.jsx', '.json', '.node'],\n\t\t\t\t\t\tpreferBuiltins: options.target === 'node',\n\t\t\t\t\t}),\n\t\t\t\t\tcommonjs({\n\t\t\t\t\t\t// use a regex to make sure to include eventual hoisted packages\n\t\t\t\t\t\tinclude: /\\/node_modules\\//,\n\t\t\t\t\t\tesmExternals: false,\n\t\t\t\t\t\trequireReturnsDefault: 'namespace',\n\t\t\t\t\t}),\n\t\t\t\t\tjson(),\n\t\t\t\t\turl({\n\t\t\t\t\t\tinclude: './**/*.svg',\n\t\t\t\t\t}),\n\t\t\t\t\tsvgr({\n\t\t\t\t\t\ticon: true,\n\t\t\t\t\t\tdimensions: true,\n\t\t\t\t\t}),\n\t\t\t\t\t{\n\t\t\t\t\t\t// We have to remove shebang so it doesn't end up in the middle of the code somewhere\n\t\t\t\t\t\ttransform: code => ({\n\t\t\t\t\t\t\tcode: code.replace(/^#![^\\n]*/, bang => {\n\t\t\t\t\t\t\t\tshebang[options.name] = bang;\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tmap: null,\n\t\t\t\t\t\t}),\n\t\t\t\t\t},\n\t\t\t\t\t(useTypescript || emitDeclaration) &&\n\t\t\t\t\t\ttypescript({\n\t\t\t\t\t\t\tcwd: options.cwd,\n\t\t\t\t\t\t\ttypescript: require(resolveFrom.silent(\n\t\t\t\t\t\t\t\toptions.cwd,\n\t\t\t\t\t\t\t\t'typescript',\n\t\t\t\t\t\t\t) || 'typescript'),\n\t\t\t\t\t\t\tcacheRoot: `./node_modules/.cache/.rts2_cache_${format}`,\n\t\t\t\t\t\t\tuseTsconfigDeclarationDir: true,\n\t\t\t\t\t\t\ttsconfigDefaults: {\n\t\t\t\t\t\t\t\tcompilerOptions: {\n\t\t\t\t\t\t\t\t\tsourceMap: options.sourcemap,\n\t\t\t\t\t\t\t\t\tdeclaration: options.generateTypes !== false,\n\t\t\t\t\t\t\t\t\tallowJs: true,\n\t\t\t\t\t\t\t\t\temitDeclarationOnly: options.generateTypes && !useTypescript,\n\t\t\t\t\t\t\t\t\t...(options.generateTypes !== false && {\n\t\t\t\t\t\t\t\t\t\tdeclarationDir: getDeclarationDir({ options, pkg }),\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tjsx: 'preserve',\n\t\t\t\t\t\t\t\t\tjsxFactory: options.jsx,\n\t\t\t\t\t\t\t\t\tjsxFragmentFactory: options.jsxFragment,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfiles: options.entries,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttsconfig: options.tsconfig,\n\t\t\t\t\t\t\ttsconfigOverride: {\n\t\t\t\t\t\t\t\tcompilerOptions: {\n\t\t\t\t\t\t\t\t\tmodule: 'ESNext',\n\t\t\t\t\t\t\t\t\ttarget: 'esnext',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t// if defines is not set, we shouldn't run babel through node_modules\n\t\t\t\t\tisTruthy(defines) &&\n\t\t\t\t\t\tbabel({\n\t\t\t\t\t\t\tbabelHelpers: 'bundled',\n\t\t\t\t\t\t\tbabelrc: false,\n\t\t\t\t\t\t\tcompact: false,\n\t\t\t\t\t\t\tconfigFile: false,\n\t\t\t\t\t\t\tinclude: 'node_modules/**',\n\t\t\t\t\t\t\tplugins: [\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\trequire.resolve('babel-plugin-transform-replace-expressions'),\n\t\t\t\t\t\t\t\t\t{ replace: defines },\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}),\n\t\t\t\t\tcustomBabel()({\n\t\t\t\t\t\tbabelHelpers: 'bundled',\n\t\t\t\t\t\textensions: EXTENSIONS,\n\t\t\t\t\t\t// use a regex to make sure to exclude eventual hoisted packages\n\t\t\t\t\t\texclude: /\\/node_modules\\//,\n\t\t\t\t\t\tpassPerPreset: true, // @see https://babeljs.io/docs/en/options#passperpreset\n\t\t\t\t\t\tcustom: {\n\t\t\t\t\t\t\tdefines,\n\t\t\t\t\t\t\tmodern,\n\t\t\t\t\t\t\tcompress: options.compress !== false,\n\t\t\t\t\t\t\ttargets: options.target === 'node' ? { node: '12' } : undefined,\n\t\t\t\t\t\t\tpragma: options.jsx,\n\t\t\t\t\t\t\tpragmaFrag: options.jsxFragment,\n\t\t\t\t\t\t\ttypescript: !!useTypescript,\n\t\t\t\t\t\t\tjsxImportSource: options.jsxImportSource || false,\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\toptions.compress !== false && [\n\t\t\t\t\t\tterser({\n\t\t\t\t\t\t\tcompress: Object.assign(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tkeep_infinity: true,\n\t\t\t\t\t\t\t\t\tpure_getters: true,\n\t\t\t\t\t\t\t\t\t// Ideally we'd just get Terser to respect existing Arrow functions...\n\t\t\t\t\t\t\t\t\t// unsafe_arrows: true,\n\t\t\t\t\t\t\t\t\tpasses: 10,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttypeof minifyOptions.compress === 'boolean'\n\t\t\t\t\t\t\t\t\t? minifyOptions.compress\n\t\t\t\t\t\t\t\t\t: minifyOptions.compress || {},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tformat: {\n\t\t\t\t\t\t\t\t// By default, Terser wraps function arguments in extra parens to trigger eager parsing.\n\t\t\t\t\t\t\t\t// Whether this is a good idea is way too specific to guess, so we optimize for size by default:\n\t\t\t\t\t\t\t\twrap_func_args: false,\n\t\t\t\t\t\t\t\tcomments: /^\\s*([@#]__[A-Z]+__\\s*$|@cc_on)/,\n\t\t\t\t\t\t\t\tpreserve_annotations: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmodule: modern,\n\t\t\t\t\t\t\tecma: modern ? 2017 : 5,\n\t\t\t\t\t\t\ttoplevel: modern || format === 'cjs' || format === 'es',\n\t\t\t\t\t\t\tmangle:\n\t\t\t\t\t\t\t\ttypeof minifyOptions.mangle === 'boolean'\n\t\t\t\t\t\t\t\t\t? minifyOptions.mangle\n\t\t\t\t\t\t\t\t\t: Object.assign({}, minifyOptions.mangle || {}),\n\t\t\t\t\t\t\tnameCache,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnameCache && {\n\t\t\t\t\t\t\t// before hook\n\t\t\t\t\t\t\toptions: loadNameCache,\n\t\t\t\t\t\t\t// after hook\n\t\t\t\t\t\t\twriteBundle() {\n\t\t\t\t\t\t\t\tif (writeMeta && nameCache) {\n\t\t\t\t\t\t\t\t\tlet filename = getNameCachePath();\n\t\t\t\t\t\t\t\t\tlet json = JSON.stringify(nameCache, null, 2);\n\t\t\t\t\t\t\t\t\tif (endsWithNewLine) json += EOL;\n\t\t\t\t\t\t\t\t\tfs.writeFile(filename, json, () => {});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\toptions.visualize && visualizer(),\n\t\t\t\t\t// NOTE: OMT only works with amd and esm\n\t\t\t\t\t// Source: https://github.com/surma/rollup-plugin-off-main-thread#config\n\t\t\t\t\t// eslint-disable-next-line new-cap\n\t\t\t\t\tuseWorkerLoader && (format === 'es' || modern) && OMT(),\n\t\t\t\t\t/** @type {import('rollup').Plugin} */\n\t\t\t\t\t({\n\t\t\t\t\t\tname: 'postprocessing',\n\t\t\t\t\t\t// Rollup 2 injects globalThis, which is nice, but doesn't really make sense for Microbundle.\n\t\t\t\t\t\t// Only ESM environments necessitate globalThis, and UMD bundles can't be properly loaded as ESM.\n\t\t\t\t\t\t// So we remove the globalThis check, replacing it with `this||self` to match Rollup 1's output:\n\t\t\t\t\t\trenderChunk(code, chunk, opts) {\n\t\t\t\t\t\t\tif (opts.format === 'umd') {\n\t\t\t\t\t\t\t\t// minified:\n\t\t\t\t\t\t\t\tcode = code.replace(\n\t\t\t\t\t\t\t\t\t/([a-zA-Z$_]+)=\"undefined\"!=typeof globalThis\\?globalThis:(\\1\\|\\|self)/,\n\t\t\t\t\t\t\t\t\t'$2',\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t// unminified:\n\t\t\t\t\t\t\t\tcode = code.replace(\n\t\t\t\t\t\t\t\t\t/(global *= *)typeof +globalThis *!== *['\"]undefined['\"] *\\? *globalThis *: *(global *\\|\\| *self)/,\n\t\t\t\t\t\t\t\t\t'$1$2',\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn { code, map: null };\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t// Grab size info before writing files to disk:\n\t\t\t\t\t\twriteBundle(_, bundle) {\n\t\t\t\t\t\t\tconfig._sizeInfo = Promise.all(\n\t\t\t\t\t\t\t\tObject.values(bundle).map(({ code, fileName }) => {\n\t\t\t\t\t\t\t\t\tif (code) {\n\t\t\t\t\t\t\t\t\t\treturn getSizeInfo(code, fileName, options.raw);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t).then(results => results.filter(Boolean).join('\\n'));\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t)\n\t\t\t\t.filter(Boolean),\n\t\t},\n\n\t\t/** @type {import('rollup').OutputOptions} */\n\t\toutputOptions: {\n\t\t\tpaths: outputAliases,\n\t\t\tglobals,\n\t\t\tstrict: options.strict === true,\n\t\t\tfreeze: false,\n\t\t\tesModule: false,\n\t\t\tsourcemap: options.sourcemap,\n\t\t\tget banner() {\n\t\t\t\treturn shebang[options.name];\n\t\t\t},\n\t\t\tformat: modern ? 'es' : format,\n\t\t\tname: options.name && options.name.replace(/^global\\./, ''),\n\t\t\textend: /^global\\./.test(options.name),\n\t\t\tdir: outputDir,\n\t\t\tentryFileNames: outputEntryFileName,\n\t\t\texports: 'auto',\n\t\t},\n\t};\n\n\treturn config;\n}\n","import sade from 'sade';\nlet { version } = require('../package.json');\n\nconst toArray = val => (Array.isArray(val) ? val : val == null ? [] : [val]);\n\nexport default handler => {\n\tconst ENABLE_MODERN = process.env.MICROBUNDLE_MODERN !== 'false';\n\n\tconst DEFAULT_FORMATS = ENABLE_MODERN ? 'modern,esm,cjs,umd' : 'esm,cjs,umd';\n\n\tconst cmd = type => (str, opts) => {\n\t\topts.watch = opts.watch || type === 'watch';\n\n\t\topts.entries = toArray(str || opts.entry).concat(opts._);\n\n\t\tif (typeof opts.compress !== 'undefined') {\n\t\t\t// Convert `--compress true/false/1/0` to booleans:\n\t\t\tif (typeof opts.compress !== 'boolean') {\n\t\t\t\topts.compress = opts.compress !== 'false' && opts.compress !== '0';\n\t\t\t}\n\t\t} else {\n\t\t\t// the default compress value is `true` for web, `false` for Node:\n\t\t\topts.compress = opts.target !== 'node';\n\t\t}\n\n\t\thandler(opts);\n\t};\n\n\tlet prog = sade('microbundle');\n\n\tprog\n\t\t.version(version)\n\t\t.option('--entry, -i', 'Entry module(s)')\n\t\t.option('--output, -o', 'Directory to place build files into')\n\t\t.option(\n\t\t\t'--format, -f',\n\t\t\t`Only build specified formats (any of ${DEFAULT_FORMATS} or iife)`,\n\t\t\tDEFAULT_FORMATS,\n\t\t)\n\t\t.option('--watch, -w', 'Rebuilds on any change', false)\n\t\t.option(\n\t\t\t'--pkg-main',\n\t\t\t'Outputs files analog to package.json main entries',\n\t\t\ttrue,\n\t\t)\n\t\t.option('--target', 'Specify your target environment (node or web)', 'web')\n\t\t.option('--external', `Specify external dependencies, or 'none'`)\n\t\t.option('--globals', `Specify globals dependencies, or 'none'`)\n\t\t.example('--globals react=React,jquery=$')\n\t\t.option('--define', 'Replace constants with hard-coded values')\n\t\t.example('--define API_KEY=1234')\n\t\t.option('--alias', `Map imports to different modules`)\n\t\t.example('--alias react=preact')\n\t\t.option(\n\t\t\t'--compress',\n\t\t\t'Compress output using Terser (default true when --target is web, false when --target is node)',\n\t\t)\n\t\t.example('build --target web --no-compress')\n\t\t.option('--strict', 'Enforce undefined global context and add \"use strict\"')\n\t\t.option('--name', 'Specify name exposed in UMD builds')\n\t\t.option('--cwd', 'Use an alternative working directory', '.')\n\t\t.option('--sourcemap', 'Generate source map')\n\t\t.example(\"watch --no-sourcemap # don't generate sourcemaps\")\n\t\t.option('--raw', 'Show raw byte size', false)\n\t\t.option('--jsx', 'A custom JSX pragma like React.createElement', 'h')\n\t\t.option(\n\t\t\t'--jsxFragment',\n\t\t\t'A custom JSX fragment pragma like React.Fragment',\n\t\t\t'Fragment',\n\t\t)\n\t\t.option(\n\t\t\t'--jsxImportSource',\n\t\t\t'Declares the module specifier to be used for importing jsx factory functions',\n\t\t)\n\t\t.option('--tsconfig', 'Specify the path to a custom tsconfig.json')\n\t\t.example('build --tsconfig tsconfig.build.json')\n\t\t.option(\n\t\t\t'--generateTypes',\n\t\t\t'Whether or not to generate types , if `types` or `typings` is set in `package.json` then it will default to be `true`',\n\t\t)\n\t\t.option('--css', 'Where to output CSS: \"inline\" or \"external\"', 'external')\n\t\t.option(\n\t\t\t'--css-modules',\n\t\t\t'Turns on css-modules for all .css imports. Passing a string will override the scopeName. eg --css-modules=\"_[hash]\"',\n\t\t\tnull,\n\t\t)\n\t\t.option(\n\t\t\t'--workers',\n\t\t\t'Bundle module workers - see https://github.com/surma/rollup-plugin-off-main-thread#auto-bundling',\n\t\t\tfalse,\n\t\t)\n\t\t.option(\n\t\t\t'--visualize',\n\t\t\t'Generate bundle makeup visualization (stats.html)',\n\t\t\tfalse,\n\t\t);\n\n\tprog\n\t\t.command('build [...entries]', '', { default: true })\n\t\t.describe('Build once and exit')\n\t\t.action(cmd('build'));\n\n\tprog\n\t\t.command('watch [...entries]')\n\t\t.describe('Rebuilds on any change')\n\t\t.action(cmd('watch'));\n\n\t// Parse argv; add extra aliases\n\treturn argv =>\n\t\tprog.parse(argv, {\n\t\t\talias: {\n\t\t\t\to: ['output', 'd'],\n\t\t\t\ti: ['entry', 'entries', 'e'],\n\t\t\t\tw: ['watch'],\n\t\t\t},\n\t\t\tboolean: ['generateTypes'],\n\t\t});\n};\n","#!/usr/bin/env node\n\nimport microbundle from './index';\nimport prog from './prog';\nimport { stdout } from './utils';\nimport logError from './log-error';\n\nconst run = opts => {\n\tmicrobundle(opts)\n\t\t.then(({ output }) => {\n\t\t\tif (output != null) stdout(output);\n\t\t\tif (!opts.watch) process.exit(0);\n\t\t})\n\t\t.catch(err => {\n\t\t\tprocess.exitCode = (typeof err.code === 'number' && err.code) || 1;\n\t\t\tlogError(err);\n\t\t\tprocess.exit();\n\t\t});\n};\n\nprog(run)(process.argv);\n"],"names":["fastRestTransform","template","types","t","slice","VISITOR","RestElement","path","state","parentKey","get","scope","generateUidIdentifier","set","args","identifier","key","push","numericLiteral","sliced","callExpression","memberExpression","clone","ident","node","argument","binding","getBinding","name","referencePaths","length","func","parentPath","isArrowFunctionExpression","arrowFunctionToExpression","constant","sameArgumentsObject","replaceWith","decl","variableDeclaration","variableDeclarator","unshiftContainer","remove","visitor","Program","childState","Map","useHelper","opts","helper","inlineHelper","literal","expression","ast","traverse","IDENT","addComment","declarations","init","isFunction","readFile","fs","stat","isDir","then","stats","isDirectory","catch","isFile","stdout","console","log","bind","stderr","error","isTruthy","obj","constructor","Object","keys","removeScope","replace","INVALID_ES3_IDENT","safeVariableName","normalized","toLowerCase","camelCase","EXTENSION","ESMODULES_TARGET","esmodules","mergeConfigItems","babel","type","configItemsToMerge","mergedItems","forEach","configItemToMerge","item","itemToMergeWithIndex","findIndex","mergedItem","file","resolved","createConfigItem","merge","options","createConfigItems","items","map","value","require","resolve","environmentPreset","presetEnvRegex","RegExp","createBabelInputPluginFactory","babelCore","custom","customOptions","pluginOptions","config","targets","isNodeTarget","defaultPlugins","jsxImportSource","pragma","pragmaFrag","typescript","defines","modern","inlineHelpers","externalHelpers","minify","transformFastRest","loose","async","filter","Boolean","babelOptions","envIdx","presets","preset","test","request","assign","useBuiltIns","bugfixes","modules","exclude","runtime","importSource","plugins","compress","generatorOpts","minified","compact","shouldPrintComment","comment","logError","err","description","message","plugin","red","bold","loc","line","column","frame","dim","stack","headlessStack","getPadLeft","str","width","char","repeat","formatSize","size","filename","raw","pretty","prettyBytes","color","green","yellow","indent","white","basename","getSizeInfo","code","gzip","brotli","Promise","all","gzipSize","brotliSize","out","normalizeMinifyOptions","minifyOptions","mangle","properties","regex","reserved","concat","toReplacementExpression","matches","match","JSON","stringify","substring","parseMappingArgument","globalStrings","processValue","globals","split","globalString","r","undefined","Array","isArray","parseAliasArgument","aliasStrings","find","replacement","getConfigFromPkgJson","cwd","hasPackageJson","pkg","packageJson","parse","pkgName","inverse","msg","String","getName","amdName","finalName","shouldCssModules","passedInOption","processCssmodulesArgument","moduleAllCss","allowOnlySuffixModule","cssModulesConfig","isWatchMode","watch","hasPassedInScopeName","generateScopedName","EXTENSIONS","WATCH_OPTS","microbundle","inputOptions","process","publishConfig","sourcemap","input","getInput","entries","source","module","output","getOutput","pkgMain","main","getEntries","multipleEntries","formats","format","from","Set","f","sort","a","b","steps","i","j","createConfig","doWatch","cache","series","outputOptions","bundle","rollup","write","_sizeInfo","targetDir","relative","dirname","sourceExist","banner","blue","join","onStart","onBuild","onError","watchers","reduce","acc","on","e","text","trim","jsOrTs","extension","glob","getDeclarationDir","result","typings","arr","indexOf","replaceName","walk","exports","includeDefault","p","import","default","getMain","entry","pkgTypeModule","mainNoExtension","mainsByFormat","es","syntax","esmodule","cjs","umd","unpkg","shebang","writeMeta","external","outputAliases","moduleAliases","alias","aliasIds","target","builtinModules","peerDeps","peerDependencies","dependencies","define","nameCache","bareNameCache","rawMinifyValue","getNameCachePath","useTypescript","extname","emitDeclaration","generateTypes","useWorkerLoader","workers","escapeStringExternals","ext","escapeStringRegexp","externalPredicate","externalTest","id","endsWithNewLine","loadNameCache","data","readFileSync","endsWith","EOL","absMain","outputDir","outputEntryFileName","onwarn","warning","warn","importer","treeshake","propertyReadSideEffects","postcss","autoprefixer","autoModules","inject","extract","css","minimize","sourceMap","nodeResolve","mainFields","browser","exportConditions","extensions","preferBuiltins","commonjs","include","esmExternals","requireReturnsDefault","json","url","svgr","icon","dimensions","transform","bang","resolveFrom","silent","cacheRoot","useTsconfigDeclarationDir","tsconfigDefaults","compilerOptions","declaration","allowJs","emitDeclarationOnly","declarationDir","jsx","jsxFactory","jsxFragmentFactory","jsxFragment","files","tsconfig","tsconfigOverride","babelHelpers","babelrc","configFile","customBabel","passPerPreset","terser","keep_infinity","pure_getters","passes","wrap_func_args","comments","preserve_annotations","ecma","toplevel","writeBundle","writeFile","visualize","visualizer","OMT","renderChunk","chunk","_","values","fileName","results","paths","strict","freeze","esModule","extend","dir","entryFileNames","version","toArray","val","handler","ENABLE_MODERN","env","MICROBUNDLE_MODERN","DEFAULT_FORMATS","cmd","prog","sade","option","example","command","describe","action","argv","o","w","boolean","run","exit","exitCode"],"mappings":"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"}